-- phpMyAdmin SQL Dump
-- version 5.2.0
-- https://www.phpmyadmin.net/
--
-- Servidor: 127.0.0.1
-- Tiempo de generación: 28-02-2023 a las 18:22:05
-- Versión del servidor: 10.4.27-MariaDB
-- Versión de PHP: 8.1.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Base de datos: `gestortpv`
--
CREATE DATABASE IF NOT EXISTS `gestortpv` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE `gestortpv`;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `detalle_venta`
--

CREATE TABLE `detalle_venta` (
  `id_venta` int(11) NOT NULL,
  `id_producto` int(11) DEFAULT NULL,
  `num_linea` int(11) NOT NULL,
  `cantidad` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `productos`
--

CREATE TABLE `productos` (
  `id_producto` int(11) NOT NULL,
  `nombre` varchar(100) NOT NULL,
  `precio` double DEFAULT 0,
  `stock` int(11) DEFAULT 0,
  `imagen` mediumblob NOT NULL DEFAULT ' '
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Volcado de datos para la tabla `productos`
--

INSERT INTO `productos` (`id_producto`, `nombre`, `precio`, `stock`, `imagen`) VALUES
(2, 'Coca-cola', 2.5, 250, 0x89504e470d0a1a0a0000000d49484452000000640000006401000000005899a8f90000013349444154785e636018057405120c0cd28c705e050343fd6138ef0103c3c9670a500ee30906c60b5f1d60bc190c8c0b6a0e4079cc020ccc1afa0d301e1079c843390c6c12e9db1c4ce03c83a5eb040c603c3ec5b5390c2a301e4f62364f42028c27e31c2dc1e001e349dc1392603800e79d33b360b800e359b4996dee59de00e5594e49319ab8162667d8936bb6f1369cb7e65dcad6d970def9ba9cef4670def19c9c7c3318cfa0cd23d3590dce6360483c958bc44b3884e0317f48baf60ec6b390ff9172ed178c2793f0a7e6f91f184fbec1cde278158cc7c0e08060520720e211cc6b40e11d40e13d40e17d40e1fd40e1819dcf0c1563fc0722f961bcff0d40b21ece7b0022e03c20830f94bc203ca0c604081b08eaff3fe0877318e4ffff477200ff7fb0a95000370f02d89039a3807a00008d3058c525274fa20000000049454e44ae426082),
(3, 'Red Bull', 3.1, 120, 0x89504e470d0a1a0a0000000d4948445200000064000000640803000000473c656600000300504c54450000000000330000660000990000cc0000ff0033000033330033660033990033cc0033ff0066000066330066660066990066cc0066ff0099000099330099660099990099cc0099ff00cc0000cc3300cc6600cc9900cccc00ccff00ff0000ff3300ff6600ff9900ffcc00ffff3300003300333300663300993300cc3300ff3333003333333333663333993333cc3333ff3366003366333366663366993366cc3366ff3399003399333399663399993399cc3399ff33cc0033cc3333cc6633cc9933cccc33ccff33ff0033ff3333ff6633ff9933ffcc33ffff6600006600336600666600996600cc6600ff6633006633336633666633996633cc6633ff6666006666336666666666996666cc6666ff6699006699336699666699996699cc6699ff66cc0066cc3366cc6666cc9966cccc66ccff66ff0066ff3366ff6666ff9966ffcc66ffff9900009900339900669900999900cc9900ff9933009933339933669933999933cc9933ff9966009966339966669966999966cc9966ff9999009999339999669999999999cc9999ff99cc0099cc3399cc6699cc9999cccc99ccff99ff0099ff3399ff6699ff9999ffcc99ffffcc0000cc0033cc0066cc0099cc00cccc00ffcc3300cc3333cc3366cc3399cc33cccc33ffcc6600cc6633cc6666cc6699cc66cccc66ffcc9900cc9933cc9966cc9999cc99cccc99ffcccc00cccc33cccc66cccc99ccccccccccffccff00ccff33ccff66ccff99ccffccccffffff0000ff0033ff0066ff0099ff00ccff00ffff3300ff3333ff3366ff3399ff33ccff33ffff6600ff6633ff6666ff6699ff66ccff66ffff9900ff9933ff9966ff9999ff99ccff99ffffcc00ffcc33ffcc66ffcc99ffccccffccffffff00ffff33ffff66ffff99ffffccffffff1212121818181e1e1e2424242a2a2a3030303636363c3c3c4242424848484e4e4e5454545a5a5a6060606666666c6c6c7272727878787e7e7e8484848a8a8a9090909696969c9c9ca2a2a2a8a8a8aeaeaeb4b4b4bababac0c0c0c6c6c6ccccccd2d2d2d8d8d8dededee4e4e4eaeaeaf0f0f0f6f6f6fcfcfc202962c30000060549444154785eed5a3d6cdb46143ea781bcc843e59d4b18c3b09610280c04e8d4a1b551a09a02645086da308c0e86064d9eea8e1d34a82ed000462671cb942c49bb75a9032100b358306a75516769a9166b51ef1d8ff7f3f88e3cdaee50205f60f3ee91bcefdeefddd1f984f923fcf669f3e95b2c75226cbc3b656c7cf530bc8f6f1560170b8ad00d26c1d7fcfacbce24b80f9df45f073f87114e54f372d39097c2d0a4dbd3ed329cf5b3a94d3cdeba67b4fb46db1f1e6f9924d58caed0c2821c2c922db3e38d100b72b048fe2bd8241ef62550fa9620393c7d3dc637ee128264637c75ea118908bdcec12996d1b8954f36c77e53d32422e1bbaaeb89d23201b89526191e6201c29d9094e14e48ca42f34e4896588070272465a0172d28e47ed1d9d76b8c1b9a443c9e8e2c02b9ff955a985a5fb8488fb0808422313244ceee2ceb87a2cef6f329c15755b8bc815fada0b6100560a7b998047629903ee91a454ed16532395d67a28abd059f495af3577813557fdbf1642c3a07f7864d025a523add128e10ee6907ec18621a7eeb490608a04b6874b238635e0bff151620987922667f1618925039a9c376dd3b80e758806068a21341b4607c95063d19a8378326c19125435d9b229f8dbd8ef45d8957b4b98cd86e05e3e5aa34db73b8e6f350a1574200206b5718d460038ac53786e113bf3a7413182435ddac028f8070246305e05311b16b952422723c5c4880181483747c3e580be051114acd85d32707ac09ee334d626dedcc13c78ff0eb668654203549279352eac3215df84d29fd04e19331643814c6fec45870f97932b76590475a24a5a03439805fdc2cafe07ab42b66d5d5f6edbb66299085719fd64691d867e6add40be0f552cf332321e55e01d5babc4ff0a0f6c6c389a2b0d72442e5aef7a0268a08009a84a841e9cb6543e481dfc89b4b3f9259561a10bfaa903e57b0e6dc1bbd1999250e1c271f3fcc64a901094d05d4912e373985152c10d869063f9b5b10bef5f47055d8323e04b5168cfdc48f60bbcb95254d72531cd582b72e8d3fe223febfa89a27c74d7e6c7ffd128b8b5191247ef0172759616d7ca31044812c409c6b78a1128931f4b96e96a30ac9b1d9f9dbec94a00a89759efbddec94a00209f2c3c0ee16a102094285b87491e4e6f9bde511c0f805969c6081848b64868c733e6fda02c6decdb101ffb1fb0a2e12965823c4433635fb80842503f16941229e191d0b4e1236d52cf18bc4b82101df04677f68b3c6c433122e926da33d48e670418388795fcc4eb2fe356391ba69c345f2d87841501857818cd210365c152d7774c8f0ea73d988953716d93d13cb5856cb1a1ba15b0a2e4df8692b7d379e6a3319061baad63449fdf2ccfd371e17499834d286db9d0a32aaeab33f6db9828b64c067c611e79292422c02f107433d1b2e922138fe324eecd857b962eb97a4e1de7069ed22615ff29ff7b904742181f5a5bae37f83fcc042378671c11ff75c215c63ad27841ed7e985285249fcd259985d9a3c4abea1f49016a13266da9a3dc2320917c9633bbf7d70e1dcc3b848d8e13a5189d6b30671af1139cf492e9fb00dea8b8a7409099157349c9a60acc22f6542e12fef4f7dde24447cd6b1c0853212315004eb4bea23fdbd82f7237dbf100524a254280516a989449911ada90864ad604195733a9e2fa7f0516a74b0c96bd8af6c38c94f773e0a78a833399d59ec8ae0024d44be475b9c63f05e862ee7110b80305f2a393f818b301a95bc295c24e74f78f444eb090fcc78cea6a11026b0cea4264bab7a2d61b02ffa6c1e01e931da22293848e2618b458b64da044773dbaf4979044b403dc9e26a8d8d60d3b2594f863c51437b1ba5e12061db091faa59dfe3cd36e36d9071cdc4bd1a5b8db685c7a7d15cd492fd663d9a6ecdf36e4b41931c2f3ef0c4dbdfdb17bd062461d48e60fec21730d8ea7abb01064c07dedb6fd746ecc3756e2f2b409334b989d6d5571fee976687089d67bd3ae829f15dc4f77bb9bdac004dc22d1219a3ae35c06ce82f5717fc673f92db0d00d74cd49e3ce875263c792012c0c6803f2c0fa6fc4aa816b3ed0d2c03d02434c21383e4d30aff65c9612e12d677d60a1c9548cc958fb0a61b954814cb92704801aaf8448027f5b2601124f12fa00274d8ace5ff720000000049454e44ae426082);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `usuarios`
--

CREATE TABLE `usuarios` (
  `nickname` varchar(100) NOT NULL,
  `nombre` varchar(100) DEFAULT NULL,
  `apellidos` varchar(100) DEFAULT NULL,
  `user_pass` int(4) NOT NULL,
  `rol` tinyint(1) NOT NULL DEFAULT 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Volcado de datos para la tabla `usuarios`
--

INSERT INTO `usuarios` (`nickname`, `nombre`, `apellidos`, `user_pass`, `rol`) VALUES
('jPolo', 'Jose polo', 'buenDia', 4444, 1),
('rbarea', 'Raul', 'Barea Rodriguez', 1234, 0),
('talonso', 'Tristan', 'Alonso', 1111, 0);

-- --------------------------------------------------------

--
-- Estructura de tabla para la tabla `ventas`
--

CREATE TABLE `ventas` (
  `id_venta` int(11) NOT NULL,
  `nickname_usuario` varchar(100) NOT NULL,
  `fecha_venta` datetime DEFAULT NULL,
  `num_mesa` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Índices para tablas volcadas
--

--
-- Indices de la tabla `detalle_venta`
--
ALTER TABLE `detalle_venta`
  ADD PRIMARY KEY (`id_venta`,`num_linea`),
  ADD KEY `id_producto` (`id_producto`);

--
-- Indices de la tabla `productos`
--
ALTER TABLE `productos`
  ADD PRIMARY KEY (`id_producto`);

--
-- Indices de la tabla `usuarios`
--
ALTER TABLE `usuarios`
  ADD PRIMARY KEY (`nickname`);

--
-- Indices de la tabla `ventas`
--
ALTER TABLE `ventas`
  ADD PRIMARY KEY (`id_venta`,`num_mesa`),
  ADD KEY `nickname_usuario` (`nickname_usuario`);

--
-- AUTO_INCREMENT de las tablas volcadas
--

--
-- AUTO_INCREMENT de la tabla `productos`
--
ALTER TABLE `productos`
  MODIFY `id_producto` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT de la tabla `ventas`
--
ALTER TABLE `ventas`
  MODIFY `id_venta` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- Restricciones para tablas volcadas
--

--
-- Filtros para la tabla `detalle_venta`
--
ALTER TABLE `detalle_venta`
  ADD CONSTRAINT `detalle_venta_ibfk_1` FOREIGN KEY (`id_venta`) REFERENCES `ventas` (`id_venta`) ON DELETE CASCADE,
  ADD CONSTRAINT `detalle_venta_ibfk_2` FOREIGN KEY (`id_producto`) REFERENCES `productos` (`id_producto`) ON DELETE SET NULL;

--
-- Filtros para la tabla `ventas`
--
ALTER TABLE `ventas`
  ADD CONSTRAINT `ventas_ibfk_1` FOREIGN KEY (`nickname_usuario`) REFERENCES `usuarios` (`nickname`);
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
